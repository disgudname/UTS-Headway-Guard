      :root {
        --navy: #232D4B;
        --navy-dark: #1b274a;
        --navy-darker: #1a2441;
        --panel-surface: linear-gradient(180deg, rgba(255, 255, 255, 0.96), rgba(245, 248, 255, 0.96));
        --panel-border-color: rgba(35, 45, 75, 0.12);
        --panel-shadow: 0 20px 45px rgba(15, 23, 42, 0.25);
        --panel-highlight: rgba(35, 45, 75, 0.06);
        --panel-text-color: #1f2937;
        --panel-heading-color: #232D4B;
        --panel-muted-text: #4b5563;
        --accent: #E57200;
        --accent-bright: #ff9c3e;
        --accent-soft: rgba(229, 114, 0, 0.28);
        --app-font-family: 'FGDC', sans-serif;
        /* Button colors for light theme */
        --btn-bg: rgba(35, 45, 75, 0.1);
        --btn-text: #1b2540;
        --btn-border: rgba(35, 45, 75, 0.18);
        --btn-hover-bg: rgba(35, 45, 75, 0.18);
        --input-bg: #ffffff;
        --input-text: #1f2937;
        --scrollbar-track: rgba(35, 45, 75, 0.08);
        --scrollbar-thumb: rgba(35, 45, 75, 0.35);
      }
      /* Dark theme panel colors - navy blues stay the same */
      body.theme-dark {
        --panel-surface: linear-gradient(180deg, rgba(30, 41, 59, 0.96), rgba(15, 23, 42, 0.96));
        --panel-border-color: rgba(15, 23, 42, 0.6);
        --panel-shadow: 0 20px 45px rgba(0, 0, 0, 0.4);
        --panel-highlight: rgba(148, 163, 184, 0.08);
        --panel-text-color: #e2e8f0;
        --panel-heading-color: #f1f5f9;
        --panel-muted-text: #94a3b8;
        --btn-bg: rgba(148, 163, 184, 0.15);
        --btn-text: #e2e8f0;
        --btn-border: rgba(148, 163, 184, 0.2);
        --btn-hover-bg: rgba(148, 163, 184, 0.25);
        --input-bg: rgba(30, 41, 59, 0.9);
        --input-text: #e2e8f0;
        --scrollbar-track: rgba(148, 163, 184, 0.1);
        --scrollbar-thumb: rgba(148, 163, 184, 0.3);
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
      /* Fix white lines between map tiles caused by sub-pixel rendering */
      .leaflet-tile-container img {
        outline: 1px solid transparent;
      }
      body.theme-dark .leaflet-tile-container img {
        outline-color: #070707;
      }
      .leaflet-popup.ondemand-driver-popup .leaflet-popup-content-wrapper {
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.25);
        color: #0f172a;
        font-family: var(--app-font-family);
        padding: 10px 14px;
        border: 2px solid rgba(35, 45, 75, 0.08);
      }
      .leaflet-popup.ondemand-driver-popup .leaflet-popup-content {
        margin: 0;
      }
      .leaflet-popup.ondemand-driver-popup .leaflet-popup-tip {
        background: #ffffff;
        border: 2px solid rgba(35, 45, 75, 0.08);
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.25);
      }
      .ondemand-driver-popup__content {
        display: flex;
        flex-direction: column;
        gap: 4px;
        min-width: 140px;
      }
      .ondemand-driver-popup__section {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .ondemand-driver-popup__label {
        font-size: 11px;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: rgba(15, 23, 42, 0.75);
      }
      .ondemand-driver-popup__value {
        font-size: 15px;
        font-weight: 700;
        color: #1f2937;
      }
      .ondemand-driver-popup__divider {
        height: 1px;
        width: 100%;
        background: rgba(35, 45, 75, 0.12);
        margin: 6px 0;
      }
      .ondemand-driver-popup__stops {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .ondemand-driver-popup__stop-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .ondemand-driver-popup__stop {
        display: flex;
        align-items: flex-start;
        gap: 8px;
      }
      .ondemand-driver-popup__stop-order {
        font-weight: 700;
        color: var(--accent);
        min-width: 32px;
        text-align: left;
      }
      .ondemand-driver-popup__stop-body {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .ondemand-driver-popup__stop-type {
        font-weight: 700;
        color: #0f172a;
      }
      .ondemand-driver-popup__stop-address {
        font-size: 13px;
        color: #1f2937;
      }
      .ondemand-driver-popup__stop-riders {
        font-size: 12px;
        color: rgba(15, 23, 42, 0.7);
      }
      .ondemand-driver-popup__stop-meta {
        font-size: 12px;
        color: #374151;
      }
      /* Ride Cards for on-demand vehicle popups */
      .ondemand-driver-popup__rides {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .ondemand-driver-popup__ride-card {
        background: rgba(35, 45, 75, 0.06);
        border: 1px solid rgba(35, 45, 75, 0.12);
        border-radius: 12px;
        padding: 12px 14px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .ondemand-driver-popup__ride-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .ondemand-driver-popup__ride-name {
        font-weight: 700;
        font-size: 15px;
        color: #1f2937;
      }
      .ondemand-driver-popup__ride-order {
        font-weight: 700;
        font-size: 12px;
        color: var(--accent);
        background: rgba(229, 114, 0, 0.2);
        padding: 3px 8px;
        border-radius: 999px;
      }
      .ondemand-driver-popup__ride-locations {
        display: flex;
        flex-direction: column;
        gap: 6px;
        font-size: 13px;
      }
      .ondemand-driver-popup__ride-location {
        display: flex;
        align-items: flex-start;
        gap: 8px;
      }
      .ondemand-driver-popup__ride-location-icon {
        flex-shrink: 0;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 700;
      }
      .ondemand-driver-popup__ride-location-icon--pickup {
        background: #4ade80;
        color: #052e16;
      }
      .ondemand-driver-popup__ride-location-icon--dropoff {
        background: #f87171;
        color: #450a0a;
      }
      .ondemand-driver-popup__ride-location-icon--onboard {
        background: #60a5fa;
        color: #1e3a5f;
      }
      .ondemand-driver-popup__ride-location-text {
        flex: 1;
        color: #374151;
        line-height: 1.4;
      }
      .custom-popup {
        position: absolute;
        background: linear-gradient(135deg, var(--navy), var(--navy-dark));
        border: 3px solid rgba(255, 255, 255, 0.92);
        border-radius: 16px;
        padding: 12px 14px;
        pointer-events: auto;
        transform: translate(-50%, -100%);
        white-space: nowrap;
        z-index: 1000;
        color: #f8fafc;
        text-transform: uppercase;
        font-family: var(--app-font-family);
        font-size: 14px;
        letter-spacing: 0.35px;
        box-shadow: 0 18px 36px rgba(15, 23, 42, 0.38);
      }
      .custom-popup-arrow {
        position: absolute;
        left: 50%;
        bottom: -10px;
        width: 0;
        height: 0;
        border-left: 10px solid transparent;
        border-right: 10px solid transparent;
        border-top: 10px solid rgba(255, 255, 255, 0.92);
        transform: translateX(-50%);
      }
      .custom-popup-close {
        position: absolute;
        bottom: 5px;
        right: 5px;
        cursor: pointer;
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        color: #1f1300;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        line-height: 20px;
        text-align: center;
        font-size: 13px;
        box-shadow: 0 10px 20px rgba(229, 114, 0, 0.35);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .custom-popup-close:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 24px rgba(229, 114, 0, 0.4);
      }
      .incident-popup {
        min-width: 280px;
        max-width: 340px;
        display: flex;
        flex-direction: column;
        gap: 12px;
        color: #f8fafc;
        text-transform: none;
        font-family: var(--app-font-family);
        letter-spacing: 0.3px;
        white-space: normal;
      }
      .incident-popup__header {
        display: flex;
        align-items: flex-start;
        gap: 14px;
      }
      .incident-popup__details {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .incident-popup__icon {
        width: 60px;
        height: 60px;
        border-radius: 16px;
        background: #ffffff;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.08), 0 12px 24px rgba(15, 23, 42, 0.35);
        flex-shrink: 0;
      }
      .incident-popup__icon img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        display: block;
      }
      .incident-popup__icon-fallback {
        font-size: 24px;
        font-weight: 800;
        letter-spacing: 2px;
        color: rgba(15, 23, 42, 0.75);
      }
      .incident-popup__title {
        font-size: 18px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1.4px;
        margin-bottom: 4px;
      }
      .incident-popup__meta {
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 13px;
        opacity: 0.92;
      }
      .incident-popup__meta-line {
        display: flex;
        align-items: center;
        gap: 6px;
        line-height: 1.3;
      }
      .incident-popup__section {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .incident-popup__section-title {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1.1px;
        font-weight: 700;
        color: rgba(255, 255, 255, 0.78);
      }
      .incident-popup__routes-list {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        font-size: 13px;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.92);
        overflow-wrap: anywhere;
      }
      .incident-popup__route {
        display: inline-flex;
        align-items: center;
        padding: 2px 10px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.55);
        border: 1px solid rgba(148, 163, 184, 0.35);
        color: rgba(248, 250, 252, 0.92);
        font-weight: 600;
        letter-spacing: 0.4px;
      }
      .incident-popup__units {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .incident-popup__unit-status-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .incident-popup__unit-status-group + .incident-popup__unit-status-group {
        padding-top: 6px;
        border-top: 1px solid rgba(255, 255, 255, 0.14);
      }
      .incident-popup__unit-status-title {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 700;
        color: rgba(255, 255, 255, 0.82);
      }
      .incident-popup__unit-list {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .incident-popup .incident-unit {
        display: inline-flex;
        align-items: center;
        font-size: 12px;
        font-weight: 700;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.55);
        color: rgba(248, 250, 252, 0.92);
        letter-spacing: 0.35px;
      }
      .map-toast {
        position: fixed;
        left: 50%;
        bottom: 20px;
        transform: translate(-50%, 20px);
        background: rgba(35, 45, 75, 0.92);
        color: #f8fafc;
        padding: 10px 16px;
        border-radius: 999px;
        font-family: var(--app-font-family);
        font-size: 14px;
        letter-spacing: 0.3px;
        box-shadow: 0 12px 24px rgba(15, 23, 42, 0.35);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease, transform 0.2s ease;
        z-index: 2000;
      }
      .map-toast.is-visible {
        opacity: 1;
        transform: translate(-50%, 0);
      }
      .cat-vehicle-icon {
        width: 0;
        height: 0;
      }
      .cat-vehicle-marker {
        --cat-marker-size: 38px;
        --cat-marker-color: #0f172a;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        width: var(--cat-marker-size);
        height: var(--cat-marker-size);
        border-radius: 50%;
        background: var(--cat-marker-color);
        color: #fff7ed;
        border: 3px solid rgba(255, 255, 255, 0.9);
        box-shadow: 0 12px 24px rgba(15, 23, 42, 0.45);
        font-family: var(--app-font-family);
        font-weight: 800;
        letter-spacing: 0.6px;
        text-transform: uppercase;
        font-size: 14px;
      }
      .cat-vehicle-marker__label {
        display: block;
        padding: 0 4px;
        text-align: center;
      }
      .cat-vehicle-tooltip {
        background: rgba(15, 23, 42, 0.92);
        color: #f8fafc;
        border-radius: 10px;
        padding: 8px 10px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        font-family: var(--app-font-family);
        font-size: 13px;
        letter-spacing: 0.35px;
        text-transform: none;
        box-shadow: 0 10px 20px rgba(15, 23, 42, 0.4);
      }
      .cat-vehicle-tooltip strong {
        display: block;
        font-size: 13px;
        margin-bottom: 4px;
        letter-spacing: 0.45px;
      }
      .cat-vehicle-tooltip__etas {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .route-pill {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 999px;
        color: #1f1300;
        font-weight: bold;
        margin-top: 10px;
        text-align: center;
        border: none;
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        box-shadow: 0 12px 24px var(--route-pill-shadow-color, rgba(229, 114, 0, 0.35));
      }
      /* ETA Cards for stop popups */
      .eta-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-top: 10px;
      }
      .eta-card {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 10px 14px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.15);
      }
      .eta-card__route {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
        min-width: 0;
      }
      .eta-card__route-badge {
        flex-shrink: 0;
        padding: 6px 12px;
        border-radius: 999px;
        font-weight: bold;
        font-size: 13px;
        text-align: center;
        white-space: nowrap;
        box-shadow: 0 4px 12px var(--eta-badge-shadow, rgba(0, 0, 0, 0.2));
      }
      .eta-card__time {
        flex-shrink: 0;
        font-size: 18px;
        font-weight: bold;
        text-align: right;
        white-space: nowrap;
      }
      .eta-card__time--arriving {
        color: #4ade80;
      }
      .eta-card__time--soon {
        color: #fbbf24;
      }
      .eta-empty {
        margin-top: 10px;
        padding: 12px;
        text-align: center;
        opacity: 0.8;
        font-style: italic;
      }
      .stop-marker-container {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        border: none;
        line-height: 0;
        cursor: pointer;
        transition: transform 0.2s ease;
      }
      .stop-marker-outer {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        width: var(--stop-marker-size, 24px);
        height: var(--stop-marker-size, 24px);
        border-radius: 50%;
        border: 2px solid var(--stop-marker-border-color, rgba(15,23,42,0.55));
        background: var(--stop-marker-gradient, #ffffff);
        box-shadow: 0 0 0 var(--stop-marker-outline-size, 0px) var(--stop-marker-outline-color, transparent),
                    0 12px 24px rgba(15,23,42,0.28);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .stop-marker-container:hover .stop-marker-outer,
      .stop-marker-container:focus-visible .stop-marker-outer {
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 0 0 var(--stop-marker-outline-size, 0px) var(--stop-marker-outline-color, transparent),
                    0 18px 32px rgba(15,23,42,0.32);
      }
      .leaflet-marker-icon.stop-marker-image-icon {
        pointer-events: auto;
        cursor: pointer;
        transition: transform 0.2s ease;
      }
      .leaflet-marker-icon.stop-marker-image-icon.leaflet-interactive:hover,
      .leaflet-marker-icon.stop-marker-image-icon.leaflet-interactive:focus-visible {
        transform: translateY(-2px) scale(1.05);
      }
      .stop-entry + .stop-entry {
        margin-top: 12px;
        padding-top: 8px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }
      .stop-entry-title {
        display: block;
        font-weight: bold;
        margin-bottom: 4px;
      }
      .stop-entry-id {
        display: block;
        font-size: 12px;
        opacity: 0.9;
        margin-bottom: 6px;
      }
      .ondemand-stop-details {
        margin-top: 10px;
        padding-top: 8px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        display: flex;
        flex-direction: column;
        gap: 8px;
        white-space: normal;
      }
      .ondemand-stop-details__heading {
        font-weight: 800;
        letter-spacing: 0.35px;
      }
      .ondemand-stop-details__vehicle {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .ondemand-stop-details__vehicle-name {
        font-weight: 800;
        color: #ffd166;
      }
      .ondemand-stop-details__address,
      .ondemand-stop-details__service,
      .ondemand-stop-details__timestamp {
        font-size: 12px;
        opacity: 0.9;
      }
      .ondemand-stop-details__row {
        display: flex;
        align-items: flex-start;
        gap: 6px;
        white-space: normal;
      }
      .ondemand-stop-details__label {
        font-weight: 700;
        min-width: 70px;
        display: inline-block;
      }
      .ondemand-stop-details__value {
        flex: 1;
        display: inline-block;
        white-space: normal;
      }
      .bus-marker {
        background: transparent;
        border: 0;
        padding: 0;
        line-height: 0;
        pointer-events: none;
      }
      .bus-marker__root {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        cursor: default;
        touch-action: none;
        user-select: none;
        overflow: visible;
      }
      .bus-marker__offroute-badge {
        position: absolute;
        top: -2px;
        right: -2px;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #dc2626;
        border: 2px solid #ffffff;
        color: #ffffff;
        font: 700 10px/12px 'FGDC', 'Inter', system-ui, -apple-system, sans-serif;
        display: none;
        align-items: center;
        justify-content: center;
        pointer-events: auto;
        box-shadow: 0 2px 6px rgba(15, 23, 42, 0.45);
        z-index: 100;
        /* Ensure badge sits above SVG which has will-change: transform */
        transform: translateZ(0);
        isolation: isolate;
      }
      .bus-label-icon {
        pointer-events: none !important;
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
        padding: 0 !important;
      }
      .bus-marker__svg {
        display: block;
        width: 100%;
        height: 100%;
        overflow: visible;
        transition: transform 0.2s ease, filter 0.2s ease;
        transform-box: view-box;
        transform-origin: 50% 50%;
        will-change: transform;
        pointer-events: none;
        position: relative;
        z-index: 1;
      }
      .bus-marker__svg .st1 {
        paint-order: stroke fill;
        transition: fill 0.2s ease, fill-opacity 0.2s ease;
        pointer-events: auto;
      }
      .bus-marker__svg .st0 {
        transition: fill 0.2s ease;
        pointer-events: auto;
      }
      /* CSS Custom Property based coloring for better performance */
      .bus-marker__root {
        --bus-marker-fill: #0f172a;
        --bus-marker-glyph: #ffffff;
      }
      .bus-marker__svg #route_color {
        fill: var(--bus-marker-fill);
      }
      .bus-marker__svg #center_ring,
      .bus-marker__svg #stopped_square,
      .bus-marker__svg #heading {
        fill: var(--bus-marker-glyph);
      }
      .bus-marker__svg #halo {
        pointer-events: none;
      }
      .bus-marker__root.is-stale .bus-marker__svg {
        opacity: 0.6;
      }
      .bus-marker__root.is-hover .bus-marker__svg {
        filter: drop-shadow(0 3px 8px rgba(15, 23, 42, 0.35));
      }
      .bus-marker__root.is-selected .bus-marker__svg {
        filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.68));
      }
      .bus-marker__root.is-selected.is-hover .bus-marker__svg {
        filter: drop-shadow(0 3px 12px rgba(15, 23, 42, 0.35)) drop-shadow(0 0 7px rgba(255, 255, 255, 0.72));
      }
      .incident-halo-icon {
        pointer-events: none !important;
      }
      .incident-halo-icon .incident-halo {
        position: absolute;
        left: 50%;
        top: 50%;
        width: var(--incident-halo-diameter, 128px);
        height: var(--incident-halo-diameter, 128px);
        margin-left: calc(-0.5 * var(--incident-halo-diameter, 128px));
        margin-top: calc(-0.5 * var(--incident-halo-diameter, 128px));
        border-radius: 50%;
        background: radial-gradient(circle, rgba(var(--incident-halo-color-rgb, 255, 90, 60), var(--incident-halo-base-opacity, 0.5)) 0%, rgba(var(--incident-halo-color-rgb, 255, 90, 60), 0) 72%);
        opacity: var(--incident-halo-base-opacity, 0.5);
        transform: scale(var(--incident-halo-start-scale, 0.25));
        transform-origin: 50% 50%;
        pointer-events: none;
        will-change: transform, opacity;
        filter: blur(0.2px);
      }
      .incident-halo--animated {
        animation: incident-halo-pulse var(--incident-halo-duration, 1600ms) cubic-bezier(0.25, 1, 0.5, 1) infinite;
      }
      .incident-halo--static {
        transform: scale(1);
        opacity: var(--incident-halo-base-opacity, 0.5);
      }
      @keyframes incident-halo-pulse {
        0% {
          transform: scale(var(--incident-halo-start-scale, 0.25));
          opacity: var(--incident-halo-base-opacity, 0.5);
        }
        70% {
          opacity: var(--incident-halo-base-opacity, 0.5);
        }
        100% {
          transform: scale(1);
          opacity: 0;
        }
      }
      @media (prefers-reduced-motion: reduce) {
        .incident-halo--animated {
          animation: none;
          transform: scale(1);
          opacity: var(--incident-halo-base-opacity, 0.5);
        }
      }
      @font-face {
        font-family: 'FGDC';
        src: url('FGDC.ttf') format('truetype');
      }
      body {
        font-family: var(--app-font-family);
        font-size: 15px;
        font-weight: 500;
        color: var(--panel-text-color);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      body.ios-font {
        --app-font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      .leaflet-container,
      .leaflet-control,
      .leaflet-popup,
      .leaflet-tooltip,
      .leaflet-marker-icon {
        font-weight: 500;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      .leaflet-marker-icon,
      .leaflet-tooltip {
        transform: translate(0, 0);
        font-size: 15px;
      }
      #map {
        height: 100%;
        width: 100%;
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      .kiosk-status-message {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: clamp(1rem, 5vw, 3rem);
        text-align: center;
        font-family: var(--app-font-family);
        font-weight: 700;
        font-size: clamp(1.5rem, 8vw, 4.5rem);
        line-height: 1.2;
        white-space: pre-line;
        color: #f8fafc;
        background: rgba(35, 45, 75, 0.82);
        backdrop-filter: blur(3px);
        border-radius: clamp(0.5rem, 3vw, 2.5rem);
        margin: clamp(0.5rem, 3vw, 2.5rem);
        box-shadow: 0 24px 60px rgba(15, 23, 42, 0.35);
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.25s ease, visibility 0.25s ease;
        pointer-events: none;
        z-index: 2400;
      }
      .kiosk-status-message.is-visible {
        opacity: 1;
        visibility: visible;
      }
      .loading-overlay {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: rgba(71, 85, 105, 0.55);
        color: #f1f5f9;
        font-family: var(--app-font-family);
        font-size: 18px;
        letter-spacing: 0.3rem;
        text-transform: uppercase;
        z-index: 3000;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transition: opacity 0.25s ease, visibility 0.25s ease;
        backdrop-filter: blur(2px);
      }
      .loading-overlay.is-visible {
        opacity: 1;
        visibility: visible;
        pointer-events: all;
      }
      .loading-overlay__inner {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }
      .loading-overlay__spinner {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: 4px solid rgba(241, 245, 249, 0.35);
        border-top-color: #f8fafc;
        animation: loading-overlay-spin 1s linear infinite;
      }
      .loading-overlay__text {
        font-size: 16px;
        letter-spacing: 0.35rem;
      }
      @keyframes loading-overlay-spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }
      /* Route Selector styling */
      .selector-panel {
        width: 340px;
        position: fixed;
        top: 10px;
        z-index: 1100;
        background: var(--panel-surface);
        border-radius: 18px;
        border: 1px solid var(--panel-border-color);
        box-shadow: var(--panel-shadow);
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        backdrop-filter: blur(12px);
        transition: transform 0.35s ease, box-shadow 0.3s ease;
        font-size: 16px;
        color: var(--panel-text-color);
      }
      #routeSelector {
        right: 10px;
      }
      #controlPanel {
        left: calc(var(--hg-nav-left-offset, 0px) + 10px);
      }
      /* Note: #routeSelector.hidden removed - now handled by .right-panel-column.hidden */
      #controlPanel.hidden {
        transform: translateX(calc(-100% - 24px));
        pointer-events: none;
      }
      .selector-panel .selector-header {
        background: linear-gradient(135deg, var(--navy), var(--navy-dark));
        color: #f8fafc;
        padding: 16px 20px 18px;
        box-shadow: inset 0 -1px 0 rgba(255, 255, 255, 0.08);
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .selector-panel .selector-header-text {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .selector-panel .selector-logo {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        border-radius: 12px;
        background: #ffffff;
        border: 1px solid rgba(35, 45, 75, 0.15);
        box-shadow: 0 8px 18px rgba(15, 23, 42, 0.18);
      }
      .selector-panel .selector-logo img {
        display: block;
        max-width: 100%;
        max-height: 120px;
        height: auto;
      }
      .selector-panel .selector-title {
        margin: 0;
        font-size: 22px;
        letter-spacing: 0.4px;
      }
      .selector-panel .selector-subtitle {
        margin-top: 6px;
        font-size: 13px;
        opacity: 0.75;
        letter-spacing: 0.3px;
      }
      .selector-panel .selector-content {
        flex: 1;
        min-height: 0;
        overflow-y: auto;
        padding: 18px 20px 22px;
        display: flex;
        flex-direction: column;
        gap: 18px;
      }
      .selector-panel .incident-alert-block {
        background: linear-gradient(135deg, rgba(254, 226, 226, 0.92), rgba(254, 202, 202, 0.78));
        border: 1px solid rgba(220, 38, 38, 0.35);
        border-radius: 18px;
        padding: 18px 20px;
        box-shadow: 0 18px 32px rgba(220, 38, 38, 0.18);
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      .selector-panel .incident-alert__header {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .selector-panel .incident-alert__title {
        margin: 0;
        font-size: 18px;
        font-weight: 700;
        letter-spacing: 0.4px;
        color: rgba(136, 19, 19, 0.95);
      }
      .selector-panel .incident-alert__subtitle {
        margin: 0;
        font-size: 13px;
        line-height: 1.4;
        color: rgba(127, 29, 29, 0.85);
      }
      .selector-panel .incident-alert__list {
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      /* ===== Demo incident preview styles (remove when demo is retired) ===== */
      .selector-panel .demo-incident-section {
        border: 3px dashed rgba(236, 72, 153, 0.65);
        border-radius: 18px;
        padding: 18px 20px;
        background: repeating-linear-gradient(135deg, rgba(250, 204, 21, 0.38), rgba(250, 204, 21, 0.38) 16px, rgba(244, 63, 94, 0.45) 16px, rgba(244, 63, 94, 0.45) 32px);
        box-shadow: 0 18px 32px rgba(190, 24, 93, 0.25);
        text-align: center;
      }
      .demo-incident-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        padding: 12px 16px;
        font-size: 15px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #0f172a;
        background: linear-gradient(135deg, #f97316, #ec4899);
        border: 4px solid #0f172a;
        border-radius: 14px;
        cursor: pointer;
        box-shadow: 0 10px 18px rgba(15, 23, 42, 0.35);
        transition: transform 0.12s ease, box-shadow 0.12s ease;
      }
      .demo-incident-button:hover {
        transform: translateY(-2px) rotate(-1.5deg);
        box-shadow: 0 16px 26px rgba(15, 23, 42, 0.45);
      }
      .demo-incident-button:active {
        transform: translateY(1px) scale(0.97) rotate(1.5deg);
      }
      .demo-incident-button.is-active {
        background: linear-gradient(135deg, #22d3ee, #a855f7);
      }
      .selector-panel .demo-incident-note {
        margin-top: 10px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.6px;
        color: rgba(15, 23, 42, 0.82);
      }
      .selector-panel .incident-alert__item {
        display: flex;
        align-items: flex-start;
        gap: 14px;
      }
      .selector-panel .incident-alert__item-button {
        appearance: none;
        background: transparent;
        border: 1px solid transparent;
        border-radius: 16px;
        padding: 8px 12px;
        width: 100%;
        text-align: left;
        display: flex;
        align-items: flex-start;
        gap: 14px;
        cursor: pointer;
        font: inherit;
        color: inherit;
        transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
      }
      .selector-panel .incident-alert__item-button:hover,
      .selector-panel .incident-alert__item-button:focus-visible {
        background: rgba(255, 255, 255, 0.6);
        border-color: rgba(136, 19, 19, 0.25);
        box-shadow: 0 10px 24px rgba(136, 19, 19, 0.15);
        outline: none;
      }
      .selector-panel .incident-alert__item-button:focus-visible .incident-alert__type {
        text-decoration: underline;
      }
      .selector-panel .incident-alert__media {
        flex: 0 0 auto;
        width: 60px;
        height: 60px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.82);
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: inset 0 0 0 1px rgba(220, 38, 38, 0.25);
      }
      .selector-panel .incident-alert__media img {
        display: block;
        max-width: 48px;
        max-height: 48px;
      }
      .selector-panel .incident-alert__content {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .selector-panel .incident-alert__type {
        font-size: 17px;
        font-weight: 700;
        letter-spacing: 0.4px;
        color: rgba(136, 19, 19, 0.95);
      }
      .selector-panel .incident-alert__meta {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        font-size: 13px;
        color: rgba(120, 53, 15, 0.95);
      }
      .selector-panel .incident-alert__location {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        font-size: 13px;
        color: rgba(124, 45, 18, 0.95);
        overflow-wrap: anywhere;
      }
      .selector-panel .incident-alert__location-label {
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 12px;
        color: rgba(136, 19, 19, 0.9);
      }
      .selector-panel .incident-alert__location-text {
        font-weight: 600;
      }
      .selector-panel .incident-alert__received {
        font-weight: 600;
      }
      .selector-panel .incident-alert__on-scene {
        font-weight: 600;
        color: rgba(21, 128, 61, 0.95);
      }
      .selector-panel .incident-alert__routes-line {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        font-size: 13px;
        color: rgba(124, 45, 18, 0.95);
      }
      .selector-panel .incident-alert__routes-list {
        font-weight: 600;
        overflow-wrap: anywhere;
      }
      .selector-panel .incident-alert__routes-label,
      .selector-panel .incident-alert__units-label {
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 12px;
        color: rgba(136, 19, 19, 0.9);
      }
      .selector-panel .incident-alert__units {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }
      .selector-panel .incident-alert__units-label {
        display: block;
      }
      .selector-panel .incident-alert__unit-status-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
        width: 100%;
      }
      .selector-panel .incident-alert__unit-status-group + .incident-alert__unit-status-group {
        padding-top: 6px;
        border-top: 1px solid rgba(136, 19, 19, 0.2);
      }
      .selector-panel .incident-alert__unit-status-title {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 700;
        color: rgba(136, 19, 19, 0.9);
      }
      .selector-panel .incident-alert__unit-list {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .selector-panel .incident-unit {
        display: inline-flex;
        align-items: center;
        font-size: 12px;
        font-weight: 700;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(255, 255, 255, 0.82);
        color: rgba(30, 41, 59, 0.85);
        letter-spacing: 0.3px;
      }
      .selector-panel .selector-content::-webkit-scrollbar {
        width: 8px;
      }
      .selector-panel .selector-content::-webkit-scrollbar-track {
        background: var(--scrollbar-track);
        border-radius: 12px;
      }
      .selector-panel .selector-content::-webkit-scrollbar-thumb {
        background: var(--scrollbar-thumb);
        border-radius: 12px;
      }
      .selector-panel .selector-content::-webkit-scrollbar-thumb:hover {
        background: rgba(229, 114, 0, 0.6);
      }
      .selector-panel .selector-group {
        background: var(--panel-highlight);
        border-radius: 14px;
        padding: 14px 16px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .selector-panel .admin-auth-control {
        margin-top: 8px;
        padding-top: 12px;
        border-top: 1px solid rgba(35, 45, 75, 0.08);
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .selector-panel .admin-auth-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
      }
      .selector-panel .admin-auth-link {
        background: none;
        border: none;
        border-radius: 0;
        padding: 0;
        font-size: 13px;
        font-weight: 600;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: var(--panel-muted-text);
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        text-decoration: none;
        transition: color 0.2s ease;
        box-shadow: none;
        transform: none;
      }
      .selector-panel .admin-auth-link:hover,
      .selector-panel .admin-auth-link:focus-visible {
        color: var(--panel-text-color);
        transform: none;
        box-shadow: none;
        background: none;
        text-decoration: underline;
        outline: none;
      }
      .selector-panel .admin-auth-link:disabled {
        cursor: default;
        color: var(--panel-muted-text);
        opacity: 0.5;
        text-decoration: none;
      }
      .selector-panel .admin-auth-logout {
        font-size: 13px;
        padding: 8px 16px;
        letter-spacing: 0.12em;
        text-transform: uppercase;
      }
      .selector-panel .admin-auth-logout:disabled {
        cursor: default;
        opacity: 0.65;
        box-shadow: none;
        transform: none;
      }
      .selector-panel .admin-auth-note {
        font-size: 12px;
        color: var(--panel-muted-text);
        line-height: 1.4;
        text-align: center;
      }
      .selector-panel .radar-control-group .radar-control {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .selector-panel .radar-control-group .radar-control-label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 1.2px;
        color: var(--panel-muted-text);
      }
      .selector-panel .radar-opacity-row {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .selector-panel .radar-opacity-value {
        font-size: 14px;
        font-weight: 700;
        min-width: 48px;
        text-align: right;
        color: var(--panel-text-color);
      }
      .selector-panel .radar-control-group input[type="range"] {
        width: 100%;
        -webkit-appearance: none;
        appearance: none;
        height: 6px;
        border-radius: 999px;
        background: var(--btn-bg);
        outline: none;
      }
      .selector-panel .radar-control-group input[type="range"]::-webkit-slider-runnable-track {
        height: 6px;
        border-radius: 999px;
        background: var(--btn-bg);
      }
      .selector-panel .radar-control-group input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: var(--accent);
        box-shadow: 0 2px 6px rgba(229, 114, 0, 0.45);
        cursor: pointer;
        border: none;
      }
      .selector-panel .radar-control-group input[type="range"]::-moz-range-track {
        height: 6px;
        border-radius: 999px;
        background: var(--btn-bg);
      }
      .selector-panel .radar-control-group input[type="range"]::-moz-range-thumb {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: var(--accent);
        box-shadow: 0 2px 6px rgba(229, 114, 0, 0.45);
        cursor: pointer;
        border: none;
      }
      .selector-panel .radar-status-message {
        font-size: 12px;
        letter-spacing: 0.3px;
        color: rgba(185, 28, 28, 0.85);
      }
      .selector-panel .radar-toggle {
        align-self: flex-start;
      }
      .selector-panel .radar-toggle[disabled] {
        cursor: not-allowed;
        opacity: 0.55;
      }
      .selector-panel .service-alerts-group {
        gap: 12px;
      }
      .selector-panel .service-alerts-toggle {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        text-align: left;
        background: linear-gradient(135deg, rgba(37, 99, 235, 0.16), rgba(79, 70, 229, 0.18));
        border: 1px solid rgba(67, 56, 202, 0.28);
        color: var(--panel-text-color);
        box-shadow: 0 10px 18px rgba(37, 99, 235, 0.18);
        transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
      }
      .selector-panel .service-alerts-toggle:hover {
        background: linear-gradient(135deg, rgba(37, 99, 235, 0.22), rgba(79, 70, 229, 0.26));
        border-color: rgba(67, 56, 202, 0.36);
        box-shadow: 0 14px 24px rgba(37, 99, 235, 0.25);
      }
      .selector-panel .service-alerts-toggle.is-expanded {
        background: linear-gradient(135deg, rgba(37, 99, 235, 0.26), rgba(59, 130, 246, 0.3));
        border-color: rgba(59, 130, 246, 0.45);
        box-shadow: 0 16px 26px rgba(59, 130, 246, 0.3);
      }
      .selector-panel .service-alerts-toggle.has-active-alerts {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.24), rgba(14, 116, 144, 0.26));
        border-color: rgba(13, 148, 136, 0.42);
        box-shadow: 0 16px 26px rgba(13, 148, 136, 0.25);
      }
      .selector-panel .service-alerts-toggle.has-active-alerts:hover {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.28), rgba(14, 116, 144, 0.32));
        border-color: rgba(13, 148, 136, 0.5);
      }
      .selector-panel .service-alerts-toggle.has-error {
        background: linear-gradient(135deg, rgba(248, 113, 113, 0.2), rgba(220, 38, 38, 0.22));
        border-color: rgba(220, 38, 38, 0.42);
        box-shadow: 0 12px 22px rgba(220, 38, 38, 0.22);
      }
      .selector-panel .service-alerts-toggle.has-error:hover {
        background: linear-gradient(135deg, rgba(248, 113, 113, 0.24), rgba(220, 38, 38, 0.28));
        border-color: rgba(220, 38, 38, 0.5);
      }
      .selector-panel .service-alerts-toggle.is-loading {
        cursor: progress;
      }
      .selector-panel .service-alerts-toggle__text {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
      .selector-panel .service-alerts-toggle__label {
        font-size: 15px;
        font-weight: 700;
        letter-spacing: 1.1px;
        text-transform: uppercase;
        color: var(--panel-heading-color);
      }
      .selector-panel .service-alerts-toggle__status {
        font-size: 13px;
        letter-spacing: 0.35px;
        color: rgba(30, 64, 175, 0.85);
      }
      .selector-panel .service-alerts-toggle.has-error .service-alerts-toggle__status {
        color: rgba(185, 28, 28, 0.9);
        font-weight: 600;
      }
      .selector-panel .service-alerts-toggle.is-loading .service-alerts-toggle__status {
        color: var(--panel-muted-text);
      }
      .selector-panel .service-alerts-toggle.has-active-alerts .service-alerts-toggle__status {
        color: rgba(13, 148, 136, 0.95);
        font-weight: 700;
      }
      .selector-panel .service-alerts-toggle__chevron {
        flex: 0 0 auto;
        width: 28px;
        height: 28px;
        border-radius: 999px;
        background: var(--panel-highlight);
        color: var(--panel-muted-text);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        transition: background 0.2s ease, color 0.2s ease;
      }
      .selector-panel .service-alerts-toggle:hover .service-alerts-toggle__chevron {
        background: var(--btn-bg);
      }
      .selector-panel .service-alerts-toggle__chevron::before {
        content: '\25BC';
      }
      .selector-panel .service-alerts-toggle.is-expanded .service-alerts-toggle__chevron::before {
        content: '\25B2';
      }
      .selector-panel .service-alerts-panel {
        border-radius: 12px;
        border: 1px solid rgba(67, 56, 202, 0.26);
        background: var(--input-bg);
        padding: 16px 18px;
        box-shadow: 0 14px 28px rgba(37, 99, 235, 0.18);
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      .selector-panel .service-alerts-panel[hidden] {
        display: none;
      }
      .selector-panel .service-alerts-panel.is-empty {
        padding: 0;
        border: none;
        box-shadow: none;
        background: transparent;
        gap: 0;
        min-height: 0;
      }
      .selector-panel .service-alerts-panel.is-loading {
        opacity: 0.75;
      }
      .selector-panel .service-alerts-panel.has-error {
        border-color: rgba(220, 38, 38, 0.32);
        box-shadow: 0 12px 24px rgba(220, 38, 38, 0.2);
      }
      .selector-panel .service-alerts-panel .service-alerts-state {
        font-size: 14px;
        letter-spacing: 0.3px;
        color: var(--panel-text-color);
        line-height: 1.4;
      }
      .selector-panel .service-alerts-panel .service-alerts-state--loading {
        color: rgba(37, 99, 235, 0.85);
        font-weight: 600;
      }
      .selector-panel .service-alerts-panel .service-alerts-state--error {
        color: rgba(185, 28, 28, 0.9);
        font-weight: 600;
      }
      .selector-panel .service-alerts-list {
        margin: 0;
        padding: 0;
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      .selector-panel .service-alerts-item {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 14px 16px;
        border-radius: 12px;
        background: rgba(37, 99, 235, 0.08);
        border: 1px solid rgba(67, 56, 202, 0.22);
      }
      .selector-panel .service-alerts-item.is-inactive {
        opacity: 0.75;
      }
      .selector-panel .service-alerts-item__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .selector-panel .service-alerts-item__title {
        font-size: 15px;
        font-weight: 700;
        letter-spacing: 0.45px;
        color: var(--panel-heading-color);
      }
      .selector-panel .service-alerts-item__status {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(37, 99, 235, 0.16);
        color: rgba(30, 64, 175, 0.9);
        font-weight: 700;
        white-space: nowrap;
      }
      .selector-panel .service-alerts-item.is-inactive .service-alerts-item__status {
        background: rgba(248, 113, 113, 0.18);
        color: rgba(185, 28, 28, 0.9);
      }
      .selector-panel .service-alerts-item__message {
        font-size: 14px;
        line-height: 1.55;
        color: var(--panel-text-color);
        white-space: pre-line;
      }
      .selector-panel .service-alerts-item__meta {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .selector-panel .service-alerts-item__meta-row {
        display: flex;
        gap: 8px;
        font-size: 12px;
        letter-spacing: 0.3px;
        color: rgba(37, 99, 235, 0.9);
      }
      .selector-panel .service-alerts-item__meta-label {
        font-weight: 700;
        text-transform: uppercase;
        color: rgba(30, 64, 175, 0.88);
      }
      .selector-panel .service-alerts-item__meta-value {
        flex: 1;
        font-weight: 600;
        color: var(--panel-text-color);
        overflow-wrap: anywhere;
      }
      .selector-panel .selector-label {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1.6px;
        color: var(--panel-muted-text);
      }
      .selector-panel .selector-control {
        position: relative;
      }
      .selector-panel .selector-control::after {
        content: '\25BC';
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
        font-size: 12px;
        color: var(--panel-muted-text);
        opacity: 0.6;
      }
      .selector-panel select {
        width: 100%;
        padding: 10px 42px 10px 14px;
        border-radius: 12px;
        border: 1px solid var(--btn-border);
        background: var(--input-bg);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
        font-size: 16px;
        font-family: var(--app-font-family);
        color: var(--input-text);
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
      }
      .selector-panel select:focus {
        outline: none;
        border-color: rgba(229, 114, 0, 0.8);
        box-shadow: 0 0 0 3px rgba(229, 114, 0, 0.2);
      }
      .selector-panel .selector-section {
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
      .selector-panel .selector-section-heading {
        display: flex;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: 12px;
        width: 100%;
      }
      .selector-panel .selector-section-heading h3 {
        margin: 0;
        font-size: 18px;
        color: var(--panel-heading-color);
        flex: 1 1 100%;
      }
      .selector-panel .selector-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
        width: 100%;
        flex: 1 1 100%;
        margin-top: 4px;
      }
      .selector-panel .selector-actions .pill-button {
        width: 100%;
      }
      .selector-panel .route-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .selector-panel label.route-option {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 12px 14px;
        background: var(--panel-highlight);
        border-radius: 14px;
        border: 1px solid transparent;
        transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background-color 0.2s ease;
        cursor: pointer;
      }
      .selector-panel label.route-option:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 26px rgba(15, 23, 42, 0.12);
        border-color: rgba(35, 45, 75, 0.25);
      }
      .selector-panel label.route-option.is-active {
        background: rgba(229, 114, 0, 0.14);
        border-color: rgba(229, 114, 0, 0.55);
        box-shadow: 0 16px 32px rgba(229, 114, 0, 0.24);
      }
      .selector-panel label.route-option--out {
        background: rgba(35, 45, 75, 0.08);
      }
      .selector-panel label.route-option input[type="checkbox"] {
        margin-top: 2px;
        width: 18px;
        height: 18px;
        accent-color: var(--accent);
        flex-shrink: 0;
        cursor: pointer;
      }
      .selector-panel label.route-option input[type="checkbox"]:focus-visible {
        outline: none;
        box-shadow: 0 0 0 3px rgba(229, 114, 0, 0.3);
        border-radius: 4px;
      }
      .selector-panel .route-option-swatch {
        display: inline-flex;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        margin-top: 2px;
        border: 2px solid rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 0 1px rgba(35, 45, 75, 0.2);
        flex-shrink: 0;
      }
      .selector-panel label.route-option input[type="checkbox"]:checked + .route-option-swatch {
        transform: scale(1.1);
        box-shadow: 0 0 0 2px rgba(229, 114, 0, 0.4);
      }
      .selector-panel .route-option-text {
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 15px;
        line-height: 1.3;
      }
      .selector-panel .route-option-name {
        font-weight: 600;
        color: var(--panel-text-color);
        letter-spacing: 0.2px;
      }
      .selector-panel .route-option-detail {
        font-size: 12px;
        color: var(--panel-muted-text);
      }
      .selector-panel button {
        border: none;
        border-radius: 999px;
        padding: 10px 16px;
        font-size: 15px;
        font-family: var(--app-font-family);
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease, color 0.2s ease;
        background: var(--btn-bg);
        color: var(--btn-text);
        border: 1px solid var(--btn-border);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }
      .selector-panel button:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.18);
        background: var(--btn-hover-bg);
      }
      .selector-panel button:focus-visible {
        outline: none;
        box-shadow: 0 0 0 3px rgba(229, 114, 0, 0.35);
      }
      .selector-panel button:active {
        transform: translateY(0);
      }
      .selector-panel .toggle-indicator {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-left: 8px;
        padding: 2px 8px;
        border-radius: 999px;
        font-size: 12px;
        letter-spacing: 0.8px;
        text-transform: uppercase;
        background: var(--panel-highlight);
        color: var(--panel-muted-text);
      }
      .selector-panel button.is-active .toggle-indicator {
        background: rgba(229, 114, 0, 0.2);
        color: #1f2937;
      }
      .selector-panel button.accent {
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        color: #1f1300;
        border-color: rgba(229, 114, 0, 0.35);
        box-shadow: 0 12px 24px rgba(229, 114, 0, 0.28);
      }
      .selector-panel button.accent:hover {
        box-shadow: 0 16px 30px rgba(229, 114, 0, 0.36);
        background: linear-gradient(135deg, #f4841a, #ffad55);
      }
      .selector-panel .pill-button {
        font-size: 16px;
        padding: 12px 20px;
        letter-spacing: 0.3px;
      }
      .selector-panel .display-mode-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
      }
      .selector-panel .display-mode-button {
        width: 100%;
      }
      .selector-panel .display-mode-button.is-active {
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        color: #1f1300;
        border-color: rgba(229, 114, 0, 0.35);
        box-shadow: 0 12px 24px rgba(229, 114, 0, 0.28);
      }
      .selector-panel .display-mode-button.is-active:hover {
        box-shadow: 0 16px 30px rgba(229, 114, 0, 0.36);
        background: linear-gradient(135deg, #f4841a, #ffad55);
      }
      .selector-panel .theme-mode-group {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      .selector-panel .theme-mode-button {
        width: 100%;
      }
      .selector-panel .theme-mode-button.is-active {
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        color: #1f1300;
        border-color: rgba(229, 114, 0, 0.35);
        box-shadow: 0 12px 24px rgba(229, 114, 0, 0.28);
      }
      .selector-panel .theme-mode-button.is-active:hover {
        box-shadow: 0 16px 30px rgba(229, 114, 0, 0.36);
        background: linear-gradient(135deg, #f4841a, #ffad55);
      }
      .selector-panel .full-width {
        width: 100%;
      }
      .panel-toggle {
        position: fixed;
        top: 50%;
        width: 34px;
        height: 70px;
        background: linear-gradient(180deg, var(--navy), var(--navy-darker));
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-50%);
        z-index: 1150;
        text-align: center;
        font-size: 22px;
        user-select: none;
        touch-action: none;
        transition: left 0.3s ease, right 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
        color: #f8fafc;
        box-shadow: 0 12px 28px rgba(15, 23, 42, 0.25);
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 0 4px;
      }
      .panel-toggle.is-hidden-mobile {
        display: none;
      }
      .panel-toggle--right {
        right: 0;
        border-top-left-radius: 14px;
        border-bottom-left-radius: 14px;
      }
      .panel-toggle--left {
        left: var(--hg-nav-left-offset, 0px);
        border-top-right-radius: 14px;
        border-bottom-right-radius: 14px;
      }
      .panel-toggle:hover {
        background: linear-gradient(180deg, #2d3a5e, #253355);
        box-shadow: 0 16px 32px rgba(15, 23, 42, 0.3);
      }
      .panel-toggle:focus-visible {
        outline: none;
        box-shadow: 0 0 0 3px var(--accent-soft), 0 16px 32px rgba(15, 23, 42, 0.3);
      }
      .panel-toggle__arrow {
        pointer-events: none;
        width: 20px;
        height: 20px;
        fill: currentColor;
        transition: transform 0.2s ease;
        flex-shrink: 0;
      }
      .panel-toggle--left[data-arrow-direction="out"] .panel-toggle__arrow {
        transform: rotate(0deg);
      }
      .panel-toggle--left[data-arrow-direction="in"] .panel-toggle__arrow {
        transform: rotate(180deg);
      }
      .panel-toggle--right[data-arrow-direction="out"] .panel-toggle__arrow {
        transform: rotate(180deg);
      }
      .panel-toggle--right[data-arrow-direction="in"] .panel-toggle__arrow {
        transform: rotate(0deg);
      }
      #routeLegend {
        position: fixed;
        top: 10px;
        left: calc(var(--hg-nav-left-offset, 0px) + 10px);
        z-index: 1100;
        background: var(--panel-surface);
        padding: 12px 14px 16px;
        border-radius: 16px;
        border: 1px solid var(--panel-border-color);
        box-shadow: var(--panel-shadow);
        max-width: 240px;
        display: none;
        max-height: 70vh;
        overflow-y: auto;
        font-size: 16px;
        color: var(--panel-text-color);
        backdrop-filter: blur(12px);
        transition: transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease;
        scrollbar-width: thin;
        scrollbar-color: rgba(35, 45, 75, 0.35) rgba(35, 45, 75, 0.08);
      }
      #routeLegend::-webkit-scrollbar {
        width: 8px;
      }
      #routeLegend::-webkit-scrollbar-track {
        background: rgba(35, 45, 75, 0.08);
        border-radius: 12px;
      }
      #routeLegend::-webkit-scrollbar-thumb {
        background: rgba(35, 45, 75, 0.35);
        border-radius: 12px;
      }
      #routeLegend .legend-title {
        font-weight: 600;
        margin: 0 0 12px;
        text-transform: uppercase;
        letter-spacing: 0.6px;
        color: var(--panel-heading-color);
        font-size: 18px;
      }
      #routeLegend .legend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 10px;
        background: var(--panel-highlight);
        border-radius: 12px;
        border: 1px solid transparent;
        transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      }
      #routeLegend .legend-item + .legend-item {
        margin-top: 10px;
      }
      #routeLegend .legend-item:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 26px rgba(15, 23, 42, 0.14);
        border-color: rgba(35, 45, 75, 0.2);
      }
      #routeLegend .legend-color {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        border: 2px solid rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 0 1px rgba(35, 45, 75, 0.2);
        flex-shrink: 0;
      }
      #routeLegend .legend-text {
        display: flex;
        flex-direction: column;
        gap: 3px;
        min-width: 0;
        flex: 1;
      }
      #routeLegend .legend-name {
        font-weight: 600;
        letter-spacing: 0.2px;
        color: var(--panel-heading-color);
        overflow-wrap: anywhere;
      }
      #routeLegend .legend-description {
        font-size: 13px;
        color: var(--panel-muted-text);
        overflow-wrap: anywhere;
      }
      @media (max-width: 600px) {
        .selector-panel {
          width: calc(100% - 32px);
          top: 16px;
        }
        #routeSelector {
          right: 16px;
        }
        #controlPanel {
          left: calc(var(--hg-nav-left-offset, 0px) + 16px);
        }
        #controlPanel.hidden {
          transform: translateX(calc(-100% - 20px));
        }
        /* Right panel column mobile sizing */
        .right-panel-column {
          width: calc(100% - 32px);
          right: 16px;
        }
        .right-panel-column .selector-panel {
          width: 100%;
        }
        .selector-panel .selector-content {
          padding: 16px;
        }
        .selector-panel .selector-title {
          font-size: 20px;
        }
        .selector-panel .selector-subtitle {
          font-size: 12px;
        }
        .selector-panel .selector-section-heading h3 {
          font-size: 16px;
        }
        .selector-panel .incident-alert__item {
          flex-direction: column;
        }
        .selector-panel .incident-alert__media {
          width: 56px;
          height: 56px;
        }
        .selector-panel .incident-alert__meta {
          gap: 6px;
        }
        .selector-panel .incident-alert__routes-line {
          gap: 4px;
        }
        .selector-panel button {
          font-size: 14px;
        }
        .selector-panel .pill-button {
          font-size: 16px;
        }
        .panel-toggle {
          width: 40px;
          height: 80px;
          font-size: 28px;
        }
        #routeLegend {
          left: calc(var(--hg-nav-left-offset, 0px) + 16px);
          right: 16px;
          top: auto;
          bottom: 88px;
          max-width: none;
          max-height: 45vh;
        }
        .credit {
          bottom: 16px;
          right: 16px;
          left: auto;
          font-size: 12px;
          padding: 8px 14px;
          letter-spacing: 0.2px;
        }
        .cookie-banner {
          padding: 14px 16px;
        }
      }
      .credit {
        position: fixed;
        bottom: 16px;
        right: 16px;
        font-size: 13px;
        color: var(--panel-muted-text);
        background: var(--panel-surface);
        border-radius: 999px;
        padding: 10px 16px;
        border: 1px solid var(--panel-border-color);
        box-shadow: 0 16px 30px rgba(15, 23, 42, 0.2);
        letter-spacing: 0.25px;
        text-transform: uppercase;
        backdrop-filter: blur(10px);
        pointer-events: none;
      }
      .cookie-banner {
        position: fixed;
        bottom: 0;
        left: var(--hg-nav-left-offset, 0px);
        right: 0;
        background: linear-gradient(135deg, rgba(35, 45, 75, 0.95), rgba(27, 39, 74, 0.95));
        color: #f8fafc;
        padding: 16px 20px;
        font-size: 14px;
        z-index: 1200;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 14px;
        flex-wrap: wrap;
        box-shadow: 0 -16px 36px rgba(15, 23, 42, 0.4);
        backdrop-filter: blur(14px);
        letter-spacing: 0.25px;
        text-align: center;
        border-top: 1px solid rgba(255, 255, 255, 0.12);
      }
      .cookie-banner button {
        margin-left: 0;
        border: none;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent-bright));
        color: #1f1300;
        padding: 10px 20px;
        font-family: var(--app-font-family);
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 12px 24px rgba(229, 114, 0, 0.35);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .cookie-banner button:hover {
        transform: translateY(-1px);
        box-shadow: 0 16px 30px rgba(229, 114, 0, 0.42);
      }
      .cookie-banner button:focus-visible {
        outline: none;
        box-shadow: 0 0 0 3px var(--accent-soft), 0 16px 30px rgba(229, 114, 0, 0.42);
      }
      .dispatcher-overheight-popup .leaflet-popup-content-wrapper {
        background: #fff5f5;
        border: 2px solid #dc2626;
        border-radius: 12px;
      }
      .dispatcher-overheight-popup .leaflet-popup-tip {
        background: #fff5f5;
        border: 2px solid #dc2626;
      }
      .dispatcher-overheight-popup .leaflet-popup-content {
        margin: 8px 12px;
      }
      .dispatcher-overheight-popup__vehicle {
        font-family: var(--app-font-family);
        font-size: 14px;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 4px;
      }
      .dispatcher-overheight-popup__block {
        font-family: var(--app-font-family);
        font-size: 13px;
        font-weight: 600;
        color: #374151;
        margin-bottom: 6px;
      }
      .dispatcher-overheight-popup__content {
        font-family: var(--app-font-family);
        font-size: 16px;
        font-weight: 800;
        letter-spacing: 0.8px;
        color: #b91c1c;
        text-transform: uppercase;
        margin-top: 2px;
      }
      .bus-popup__capacity {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .bus-popup__capacity-bar {
        width: 100%;
        height: 14px;
        background: rgba(35, 45, 75, 0.12);
        border-radius: 7px;
        overflow: hidden;
        position: relative;
        border: 1px solid rgba(35, 45, 75, 0.2);
      }
      .bus-popup__capacity-fill {
        height: 100%;
        background: linear-gradient(90deg, #10b981, #059669);
        border-radius: 7px;
        transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1), background 0.5s ease-in-out;
      }
      .bus-popup__capacity-fill--initial {
        animation: capacityFillGrow 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        transform-origin: left center;
      }
      @keyframes capacityFillGrow {
        from {
          transform: scaleX(0);
          opacity: 0.5;
        }
        to {
          transform: scaleX(1);
          opacity: 1;
        }
      }
      .bus-popup__capacity-text {
        font-size: 12px;
        font-weight: 600;
        color: #4b5563;
        text-align: center;
      }
      .bus-popup__stops {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .bus-popup__stop {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 6px 0;
        border-bottom: 1px solid rgba(35, 45, 75, 0.08);
      }
      .bus-popup__stop:last-child {
        border-bottom: none;
      }
      .bus-popup__stop-name {
        flex: 1;
        font-size: 13px;
        font-weight: 600;
        color: #1f2937;
        line-height: 1.3;
      }
      .bus-popup__stop-eta {
        font-size: 12px;
        font-weight: 700;
        color: var(--accent);
        white-space: nowrap;
        min-width: 60px;
        text-align: right;
      }
      /* Stop popup route and ETA styles */
      .stop-popup__route-section {
        padding: 2px 0;
      }
      .stop-popup__route-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
      }
      .stop-popup__route-color {
        width: 14px;
        height: 14px;
        border-radius: 4px;
        flex-shrink: 0;
      }
      .stop-popup__route-name {
        font-size: 14px;
        font-weight: 700;
        color: #1f2937;
        line-height: 1.2;
      }
      .stop-popup__etas {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 6px;
      }
      .stop-popup__eta-pill {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 5px 10px;
        background: linear-gradient(135deg, rgba(35, 45, 75, 0.08), rgba(35, 45, 75, 0.04));
        border: 1px solid rgba(35, 45, 75, 0.12);
        border-radius: 20px;
        font-size: 13px;
        font-weight: 700;
        color: #374151;
        white-space: nowrap;
      }
      .stop-popup__eta-pill--arriving {
        background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.08));
        border-color: rgba(34, 197, 94, 0.3);
        color: #15803d;
      }
      .stop-popup__eta-then {
        font-size: 11px;
        font-weight: 500;
        color: #9ca3af;
        text-transform: lowercase;
      }
      .bus-popup__drivers-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .bus-popup__driver-row {
        display: flex;
        flex-direction: column;
        gap: 4px;
        padding: 8px 10px;
        border-radius: 8px;
        background: rgba(35, 45, 75, 0.04);
        border: 1px solid rgba(35, 45, 75, 0.08);
      }
      .bus-popup__driver-row:first-child {
        border-left: 3px solid rgba(220, 38, 38, 0.6);
      }
      .bus-popup__driver-row:last-child {
        border-left: 3px solid rgba(34, 197, 94, 0.6);
      }
      .bus-popup__driver-name {
        font-size: 14px;
        font-weight: 700;
        color: #1f2937;
        line-height: 1.3;
      }
      .bus-popup__driver-meta {
        font-size: 12px;
        font-weight: 600;
        color: #4b5563;
        line-height: 1.3;
      }
      .bus-popup__driver-label {
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        font-size: 11px;
      }
      .bus-popup__driver-row:first-child .bus-popup__driver-label {
        color: rgba(185, 28, 28, 0.9);
      }
      .bus-popup__driver-row:last-child .bus-popup__driver-label {
        color: rgba(21, 128, 61, 0.9);
      }
      /* Training (Junior/Senior) driver labels - orange for both */
      .bus-popup__driver-label--training {
        color: #FF8C00 !important;
      }
      /* Single driver styling - use green (incoming) style */
      .bus-popup__driver-row--single {
        border-left: 3px solid rgba(34, 197, 94, 0.6);
      }
      /* Vehicle/Block/Route info card */
      .bus-popup__info-card {
        border-left: 3px solid;
      }
      .bus-popup__info-line {
        line-height: 1.4;
      }
      .bus-popup__info-line--route {
        font-size: 14px;
        font-weight: 700;
        color: #1f2937;
      }
      .bus-popup__info-line--block {
        font-size: 12px;
        font-weight: 600;
        color: #4b5563;
      }
      .bus-popup__info-line--meta {
        font-size: 12px;
        font-weight: 500;
        color: #6b7280;
      }
      .bus-popup__info-line--vehicle {
        font-size: 12px;
        font-weight: 600;
        color: #6b7280;
      }
      .bus-popup__no-data {
        font-size: 12px;
        color: #6b7280;
        font-style: italic;
        padding: 2px 0;
      }
      .bus-popup__status-message {
        font-size: 12px;
        color: #6b7280;
        padding: 2px 0;
      }

      /* ===================================
         Right Column Container (Status + Route Controls)
         =================================== */
      .right-panel-column {
        position: fixed;
        top: 10px;
        right: 10px;
        width: 340px;
        max-height: calc(100vh - 20px);
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 1100;
        pointer-events: none;
        transition: transform 0.35s ease;
      }
      .right-panel-column > * {
        pointer-events: auto;
      }
      .right-panel-column.hidden {
        transform: translateX(calc(100% + 24px));
        pointer-events: none;
      }
      /* When inside the column, panels are no longer fixed-position */
      .right-panel-column .selector-panel {
        position: relative;
        top: auto;
        right: auto;
        width: 100%;
        max-height: none;
        flex: 0 1 auto;
      }
      /* Override ID-specific positioning when inside column */
      .right-panel-column #routeSelector,
      .right-panel-column #statusPanel {
        right: auto;
        left: auto;
      }
      /* When both panels are open, split 50/50 */
      .right-panel-column .selector-panel.panel--half {
        flex: 1 1 50%;
        min-height: 0;
        max-height: calc(50vh - 15px);
      }
      /* When one panel is collapsed, the other takes remaining space */
      .right-panel-column .selector-panel.panel--full {
        flex: 1 1 auto;
        max-height: calc(100vh - 20px);
      }
      .right-panel-column .selector-panel.panel--collapsed {
        flex: 0 0 auto;
        max-height: none;
      }
      /* Collapsed panel styling */
      .right-panel-column .selector-panel.is-collapsed .selector-content {
        display: none;
      }
      .right-panel-column .selector-panel.is-collapsed .selector-header {
        cursor: pointer;
      }

      /* ===================================
         Status Panel Specific Styles
         =================================== */
      #statusPanel .selector-header {
        padding: 12px 16px 14px;
      }
      #statusPanel .selector-title {
        font-size: 18px;
      }
      #statusPanel .selector-subtitle {
        display: none;
      }
      #statusPanel .selector-content {
        padding: 14px 16px 16px;
        overflow: visible;
        gap: 14px;
      }
      /* Status Panel must not scroll */
      #statusPanel.panel--half .selector-content,
      #statusPanel.panel--full .selector-content {
        overflow: hidden;
      }
      /* Status section styling */
      .status-section {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .status-section + .status-section {
        padding-top: 10px;
        border-top: 1px solid var(--panel-border-color);
      }
      .status-section__label {
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 0.8px;
        text-transform: uppercase;
        color: var(--panel-muted-text);
      }
      .status-section__value {
        font-size: 15px;
        font-weight: 500;
        color: var(--panel-text-color);
        line-height: 1.4;
      }
      .status-section__value--empty {
        color: var(--panel-muted-text);
        font-style: italic;
      }
      .status-next-shift {
        font-style: italic;
        color: var(--panel-muted-text);
        font-size: 13px;
      }
      .status-section__list {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .status-section__list-item {
        font-size: 14px;
        color: var(--panel-text-color);
      }
      /* Active Conditions styling */
      .status-condition {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        color: var(--panel-text-color);
      }
      .status-condition--warn {
        color: #d97706;
      }
      body.theme-dark .status-condition--warn {
        color: #fbbf24;
      }
      .status-condition__indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        flex-shrink: 0;
      }
      .status-condition__indicator--online {
        background: #22c55e;
      }
      .status-condition__indicator--offline {
        background: #f59e0b;
      }
      .status-condition__indicator--na {
        background: #9ca3af;
      }
      /* Active Incidents collapsible section */
      .status-incidents-toggle {
        display: flex;
        align-items: center;
        gap: 6px;
        background: none;
        border: none;
        padding: 0;
        margin: 0;
        font: inherit;
        color: var(--panel-text-color);
        cursor: pointer;
        font-size: 14px;
        text-align: left;
        width: 100%;
      }
      .status-incidents-toggle:hover {
        color: var(--accent);
      }
      .status-incidents-toggle__label {
        flex: 1;
      }
      .status-incidents-toggle__count {
        font-size: 12px;
        font-weight: 600;
        min-width: 20px;
        height: 20px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        background: var(--panel-highlight);
        color: var(--panel-muted-text);
      }
      .status-incidents-toggle__count:not(:empty) {
        padding: 0 6px;
      }
      .status-condition__indicator--active {
        background: #f59e0b;
        box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.2);
      }
      .status-condition__indicator--none {
        background: #9ca3af;
      }
      .status-incidents-toggle__chevron {
        width: 10px;
        height: 10px;
        flex-shrink: 0;
        transition: transform 0.2s ease;
        opacity: 0.5;
      }
      .status-incidents-toggle:hover .status-incidents-toggle__chevron {
        opacity: 1;
      }
      .status-incidents-toggle__chevron path {
        fill: none;
        stroke: currentColor;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      .status-incidents-toggle.is-expanded .status-incidents-toggle__chevron {
        transform: rotate(90deg);
      }
      .status-incidents-list {
        display: none;
        flex-direction: column;
        gap: 8px;
        margin-top: 8px;
        padding-left: 14px;
      }
      .status-incidents-toggle.is-expanded + .status-incidents-list {
        display: flex;
      }
      .status-incident {
        display: flex;
        flex-direction: column;
        gap: 2px;
        font-size: 13px;
        padding: 6px 0;
        border-bottom: 1px solid var(--panel-border-color);
      }
      .status-incident:last-child {
        border-bottom: none;
      }
      .status-incident__type {
        font-weight: 600;
        color: var(--panel-text-color);
      }
      .status-incident__location {
        color: var(--panel-muted-text);
      }
      .status-incident__meta {
        display: flex;
        gap: 12px;
        font-size: 12px;
        color: var(--panel-muted-text);
      }
      /* System State styling */
      .status-flags {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .status-flag {
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 4px;
        background: var(--panel-highlight);
        color: var(--panel-muted-text);
      }
      /* Collapsed header toggle affordance */
      .selector-header__toggle {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        width: 20px;
        height: 20px;
        transition: transform 0.2s ease;
      }
      .selector-header__toggle path {
        fill: rgba(255, 255, 255, 0.7);
      }
      .selector-panel.is-collapsed .selector-header__toggle {
        transform: translateY(-50%) rotate(-90deg);
      }
      .selector-header--collapsible {
        position: relative;
        cursor: pointer;
      }
      .selector-header--collapsible:hover {
        background: linear-gradient(135deg, #2d3a5e, var(--navy-dark));
      }

